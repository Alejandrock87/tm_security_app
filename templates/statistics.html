{% extends "base.html" %}

{% block styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/statistics.css') }}">
{% endblock %}

{% block content %}
<div class="main-content statistics-wrapper py-4 mb-5">
  <div class="container-fluid statistics-container">
    <!-- Encabezado de Estadísticas -->
    <div class="statistics-header mb-4">
      <h2>Estadísticas</h2>
      <p>
        Análisis detallado de los incidentes de seguridad para mejorar 
        la prevención y respuesta.
      </p>
    </div>

    <!-- Mensaje de datos vacíos -->
    <div id="emptyDataMessage" class="alert alert-info empty-data-message" style="display: none;">
      <!-- Se mostrará dinámicamente si no hay datos -->
    </div>

    <!-- Summary Cards -->
    <div class="summary-section mb-4">
      <div class="row g-3">
        <div class="col-6 col-md-3">
          <div class="stat-card total">
            <i class="fas fa-chart-bar"></i>
            <h3 id="totalIncidents">-</h3>
            <p>Total Incidentes</p>
          </div>
        </div>
        <div class="col-6 col-md-3">
          <div class="stat-card danger">
            <i class="fas fa-exclamation-triangle"></i>
            <h3 id="mostAffectedStation">-</h3>
            <p>Estación más Afectada</p>
          </div>
        </div>
        <div class="col-6 col-md-3">
          <div class="stat-card warning">
            <i class="fas fa-clock"></i>
            <h3 id="mostDangerousHour">-</h3>
            <p>Hora más Insegura</p>
          </div>
        </div>
        <div class="col-6 col-md-3">
          <div class="stat-card info">
            <i class="fas fa-tag"></i>
            <h3 id="mostCommonType">-</h3>
            <p>Tipo más Común</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Filtros Rápidos -->
    <div class="quick-filters mb-4">
      <div class="scroll-container">
        <button class="filter-chip active" data-period="all">Todos</button>
        <button class="filter-chip" data-period="today">Hoy</button>
        <button class="filter-chip" data-period="week">Esta Semana</button>
        <button class="filter-chip" data-period="month">Este Mes</button>
      </div>
    </div>

    <!-- Tarjetas Interactivas (Tipos de Incidentes y Estaciones Más Afectadas) -->
    <div class="row mb-4">
      <!-- Tipos de Incidentes -->
      <div class="col-12 col-md-6 mb-4">
        <div class="detail-card">
          <div class="card-header">
            <h5>Tipos de Incidentes</h5>
          </div>
          <div class="chart-container">
            <canvas id="incidentTypesChart"></canvas>
          </div>
          <div class="scroll-container">
            <div id="incidentTypesList" class="scrollable-list">
              <!-- Lista de tipos de incidentes se cargará dinámicamente -->
            </div>
          </div>
        </div>
      </div>

      <!-- Estaciones más Afectadas -->
      <div class="col-12 col-md-6 mb-4">
        <div class="detail-card">
          <div class="card-header">
            <h5>Estaciones más Afectadas</h5>
          </div>
          <div class="chart-container">
            <canvas id="stationsChart"></canvas>
          </div>
          <div class="scroll-container">
            <div id="stationsList" class="scrollable-list">
              <!-- Lista de estaciones más afectadas se cargará dinámicamente -->
            </div>
          </div>
        </div>
      </div>
    </div>
  </div> <!-- /.statistics-container -->
</div> <!-- /.main-content.statistics-wrapper -->

<!-- Librerías y Scripts adicionales -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="{{ url_for('static', filename='js/statistics.js') }}"></script>
{% endblock %}
